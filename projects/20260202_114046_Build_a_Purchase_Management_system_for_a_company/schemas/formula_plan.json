{
  "formulas": [
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned1",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned1\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 1 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 1
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay1",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay1\",if(AND(O4:O<>\"\",N4:N<>\"\"),O4:O-DATEVALUE(N4:N),\"\")))",
      "description": "Stage 1 delay = Actual1 - DATEVALUE(Planned1) (Planned stored as text)",
      "dependencies": [
        "Planned1",
        "Actual1"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 1
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned2",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned2\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 2 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 2
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay2",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay2\",if(AND(AF4:AF<>\"\",AE4:AE<>\"\"),AF4:AF-DATEVALUE(AE4:AE),\"\")))",
      "description": "Stage 2 delay = Actual2 - DATEVALUE(Planned2) (Planned stored as text)",
      "dependencies": [
        "Planned2",
        "Actual2"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 2
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned3",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned3\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 3 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 3
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay3",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay3\",if(AND(AN4:AN<>\"\",AM4:AM<>\"\"),AN4:AN-DATEVALUE(AM4:AM),\"\")))",
      "description": "Stage 3 delay = Actual3 - DATEVALUE(Planned3) (Planned stored as text)",
      "dependencies": [
        "Planned3",
        "Actual3"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 3
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned4",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned4\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 4 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 4
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay4",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay4\",if(AND(AX4:AX<>\"\",AW4:AW<>\"\"),AX4:AX-DATEVALUE(AW4:AW),\"\")))",
      "description": "Stage 4 delay = Actual4 - DATEVALUE(Planned4) (Planned stored as text)",
      "dependencies": [
        "Planned4",
        "Actual4"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 4
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned5",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned5\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 5 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 5
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay5",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay5\",if(AND(BI4:BI<>\"\",BH4:BH<>\"\"),BI4:BI-DATEVALUE(BH4:BH),\"\")))",
      "description": "Stage 5 delay = Actual5 - DATEVALUE(Planned5) (Planned stored as text)",
      "dependencies": [
        "Planned5",
        "Actual5"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 5
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned6",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned6\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 6 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 6
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay6",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay6\",if(AND(BV4:BV<>\"\",BU4:BU<>\"\"),BV4:BV-DATEVALUE(BU4:BU),\"\")))",
      "description": "Stage 6 delay = Actual6 - DATEVALUE(Planned6) (Planned stored as text)",
      "dependencies": [
        "Planned6",
        "Actual6"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 6
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned7",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned7\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 7 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 7
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay7",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay7\",if(AND(CF4:CF<>\"\",CE4:CE<>\"\"),CF4:CF-DATEVALUE(CE4:CE),\"\")))",
      "description": "Stage 7 delay = Actual7 - DATEVALUE(Planned7) (Planned stored as text)",
      "dependencies": [
        "Planned7",
        "Actual7"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 7
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned8",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned8\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 8 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 8
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay8",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay8\",if(AND(CS4:CS<>\"\",CR4:CR<>\"\"),CS4:CS-DATEVALUE(CR4:CR),\"\")))",
      "description": "Stage 8 delay = Actual8 - DATEVALUE(Planned8) (Planned stored as text)",
      "dependencies": [
        "Planned8",
        "Actual8"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 8
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned9",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned9\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 9 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 9
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay9",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay9\",if(AND(DD4:DD<>\"\",DC4:DC<>\"\"),DD4:DD-DATEVALUE(DC4:DC),\"\")))",
      "description": "Stage 9 delay = Actual9 - DATEVALUE(Planned9) (Planned stored as text)",
      "dependencies": [
        "Planned9",
        "Actual9"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 9
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned10",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned10\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 10 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 10
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay10",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay10\",if(AND(DO4:DO<>\"\",DN4:DN<>\"\"),DO4:DO-DATEVALUE(DN4:DN),\"\")))",
      "description": "Stage 10 delay = Actual10 - DATEVALUE(Planned10) (Planned stored as text)",
      "dependencies": [
        "Planned10",
        "Actual10"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 10
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Planned11",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Planned11\",IF(A4:A=\"\",\"\",TEXT(A4:A, \"yyyy-mm-dd hh:mm:ss\"))))",
      "description": "Stage 11 planned calculated from Timestamp (Col A) formatted as text yyyy-mm-dd hh:mm:ss",
      "dependencies": [
        "Timestamp"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": true,
      "is_delay_formula": false,
      "stage_number": 11
    },
    {
      "sheet": "Purchase Workflow Register",
      "target_column": "Delay11",
      "start_row": 4,
      "formula": "=ARRAYFORMULA(if(row(A4:A)=4,\"Delay11\",if(AND(DY4:DY<>\"\",DX4:DX<>\"\"),DY4:DY-DATEVALUE(DX4:DX),\"\")))",
      "description": "Stage 11 delay = Actual11 - DATEVALUE(Planned11) (Planned stored as text)",
      "dependencies": [
        "Planned11",
        "Actual11"
      ],
      "apply_to_all_rows": true,
      "is_planned_formula": false,
      "is_delay_formula": true,
      "stage_number": 11
    }
  ],
  "validation_rules": [],
  "conditional_formatting": []
}