{
  "formulas": [
    {
      "sheet": "Orders",
      "target_column": "OrderStatus",
      "start_row": 2,
      "formula": "=IF(TODAY() > OrderDate + 30, IF(OrderStatus <> \"Completed\", \"Pending\", OrderStatus), OrderStatus)",
      "description": "Sets the order status to 'Pending' if 30 days have passed since the OrderDate and the status is not already 'Completed'.",
      "dependencies": [
        "OrderDate",
        "OrderStatus"
      ],
      "apply_to_all_rows": true
    },
    {
      "sheet": "OrderItems",
      "target_column": "ItemPrice",
      "start_row": 2,
      "formula": "=IFNA(VLOOKUP(ProductID, Products!A:G, 4, FALSE) * Quantity, 0)",
      "description": "Calculates the total price for the order item by looking up the product's price and multiplying it by the quantity ordered.",
      "dependencies": [
        "ProductID",
        "Quantity"
      ],
      "apply_to_all_rows": true
    },
    {
      "sheet": "Customers",
      "target_column": "Status",
      "start_row": 2,
      "formula": "=IF(ISBLANK(Email), \"Inactive\", IF(TODAY() - CreatedDate > 365, \"Long-term\", \"Active\"))",
      "description": "Determines customer status based on whether they have an email and their account's longevity.",
      "dependencies": [
        "Email",
        "CreatedDate"
      ],
      "apply_to_all_rows": true
    },
    {
      "sheet": "Payments",
      "target_column": "PaymentStatus",
      "start_row": 2,
      "formula": "=IF(PaymentAmount < VLOOKUP(OrderID, Orders!A:D, 4, FALSE), \"Partial\", \"Paid\")",
      "description": "Sets payment status to 'Partial' if the payment amount is less than the order's total amount, otherwise 'Paid'.",
      "dependencies": [
        "PaymentAmount",
        "OrderID"
      ],
      "apply_to_all_rows": true
    }
  ],
  "validation_rules": [],
  "conditional_formatting": []
}